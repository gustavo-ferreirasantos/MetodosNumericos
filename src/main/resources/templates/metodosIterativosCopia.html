<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Método Iterativo – Gauss-Seidel</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
            background: #eef2f7;
        }
        header {
            background: #0d6efd;
            color: white;
            padding: 2rem 0;
            text-align: center;
            border-radius: 0 0 18px 18px;
            margin-bottom: 30px;
        }
        .card {
            border-radius: 16px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.1);
        }
        .matrix-input {
            width: 80px;
            text-align: center;
        }
        .example-btn {
            border-radius: 20px;
            padding: 6px 20px;
        }
    </style>
</head>
<body>

<header>
    <h1 class="fw-bold"><i class="bi bi-lightning-charge"></i> Método Iterativo – Gauss-Seidel</h1>
    <p class="fs-5">Resolução de sistemas por aproximações sucessivas</p>
</header>

<div class="container">

    <!-- EXEMPLOS -->
    <div class="card p-4 mb-4">
        <h4 class="text-primary fw-bold"><i class="bi bi-folder-check"></i> Exemplos</h4>

        <div class="text-center mt-3">
            <button class="btn btn-outline-primary example-btn" onclick="exemplo1()">Exemplo 1</button>
            <button class="btn btn-outline-danger example-btn" onclick="limpar()">Limpar</button>
        </div>

        <hr>

        <div class="text-center">
            <img src="/t2_ex1.png" class="img-fluid shadow" style="max-width:420px;">
            <p class="text-muted mt-2">Circuito do Exemplo 1 — Ponte de Wheatstone</p>
        </div>
    </div>

    <!-- FORMULÁRIO -->
    <div class="card p-4">
        <form method="post" th:action="@{/metodoIterativo}">
            <div class="mb-3">
                <label class="fw-semibold">Número de equações (n):</label>
                <input type="number" id="n" name="n" value="3" min="2" max="10"
                       class="form-control" style="width:120px;">
            </div>

            <div id="matrizContainer"></div>

            <button class="btn btn-primary w-100 fw-bold mt-3">
                <i class="bi bi-play-circle"></i> Calcular
            </button>
        </form>
    </div>

    <!-- RESULTADOS -->
    <div class="card p-4 mt-4" th:if="${res != null}">
        <h4 class="text-success fw-bold"><i class="bi bi-check-circle"></i> Resultado</h4>

        <div th:each="valor, iter : ${res}" class="mt-2">
            <strong th:text="'x' + ${iter.index+1} + '='"></strong>
            <span th:text="${valor}"></span>
        </div>
    </div>

    <div class="text-center mt-4">
        <a href="/home" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Voltar
        </a>
    </div>

</div>

<script>
    function gerarCampos() {
        let n = document.getElementById("n").value;
        let box = document.getElementById("matrizContainer");
        box.innerHTML = "";

        let tabela = "<table class='table table-bordered text-center'>";
        for (let i = 0; i < n; i++) {
            tabela += "<tr>";
            for (let j = 0; j < n; j++) {
                tabela += `
                    <td><input class="form-control matrix-input"
                        name="a${i}_${j}" type="number" step="any"></td>`;
            }
            tabela += `
                <td><input class="form-control matrix-input"
                    name="b${i}" type="number" step="any"></td>`;
            tabela += "</tr>";
        }
        tabela += "</table>";
        box.innerHTML = tabela;
    }

    window.onload = gerarCampos;
    document.getElementById("n").onchange = gerarCampos;

    // EXEMPLO 1 – PONTE DE WHEATSTONE
    function exemplo1() {
        document.getElementById("n").value = 3;
        gerarCampos();

        const A = [
            [260, -120, -120],
            [-120, 240, -120],
            [-120, -120, 260]
        ];
        const b = [30, 0, 0];

        preencher(A, b);
    }

    function preencher(A, b) {
        for (let i = 0; i < A.length; i++) {
            for (let j = 0; j < A.length; j++) {
                document.getElementsByName(`a${i}_${j}`)[0].value = A[i][j];
            }
            document.getElementsByName(`b${i}`)[0].value = b[i];
        }
    }

    function limpar() {
        gerarCampos();
    }
</script>

<footer class="mt-5 text-center p-3 bg-primary text-white">
    © 2025 — UNIVASF | Cálculo Numérico – Métodos Iterativos
</footer>

</body>
</html>
