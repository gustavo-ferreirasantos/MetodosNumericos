<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8"/>
    <title>Ex3 — Regressão por Mínimos Quadrados</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">
    <h3>Exemplo 3 — Regressão (x, F(x))</h3>

    <form method="post" action="/interpolacaoPolinominal/ex3">
        <div id="rows" class="mb-3"></div>

        <div class="mb-3">
            <button type="button" class="btn btn-sm btn-outline-secondary" onclick="addRow()">+ Adicionar linha</button>
            <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeLast()">- Remover última</button>
            <button type="button" class="btn btn-sm btn-info" onclick="loadExample3()">Carregar Exemplo</button>
        </div>

        <button type="submit" class="btn btn-success w-100">Calcular Ajustes</button>
    </form>

    <hr/>

    <div class="mt-4" th:if="${resultado}">
        <h4 class="fw-bold text-primary">Resultado</h4>

        <pre class="p-3 bg-light border rounded shadow-sm"
             style="white-space: pre-wrap; font-size: 1.05rem;"
             th:text="${resultado}">
    </pre>
    </div>
</div>

<script>
    function createRow(x='', y='') {
        const div = document.createElement('div');
        div.className = 'row mb-2 g-2 align-items-center';
        div.innerHTML = `
            <div class="col-5">
                <input name="x" type="number" step="any" class="form-control" placeholder="x" value="${x}">
            </div>
            <div class="col-5">
                <input name="fx" type="number" step="any" class="form-control" placeholder="F(x)" value="${y}">
            </div>
            <div class="col-2">
                <button type="button" class="btn btn-sm btn-outline-danger w-100" onclick="this.closest('.row').remove()">Remover</button>
            </div>`;
        return div;
    }

    function addRow(x='', y='') { document.getElementById('rows').appendChild(createRow(x,y)); }
    function removeLast() { const r=document.getElementById('rows'); if(r.lastElementChild) r.removeChild(r.lastElementChild); }

    function loadExample3() {
        // x: 0 1.5 2.6 4.2 6 8.2 10 11.4
        // F(x): 18 13 11 9 6 4 2 1
        const xs = [0,1.5,2.6,4.2,6,8.2,10,11.4];
        const fxs = [18,13,11,9,6,4,2,1];
        const rows = document.getElementById('rows'); rows.innerHTML = '';
        for (let i=0;i<xs.length;i++) addRow(xs[i], fxs[i]);
    }

    (function(){ addRow(); addRow(); addRow(); })();
</script>
</body>
</html>
